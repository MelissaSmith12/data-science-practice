Option Compare Database
Option Explicit
'This Module loads Common Core Literacy Standards Crosswalk files. Please note that crosswalk alignment data must be manually deleted
Sub TexasMathProcess()
Dim strDir As String
Dim strFile As String
Dim strTable As String
Dim DupCount As Integer

On Error GoTo ErrorExit

DoCmd.SetWarnings False

DoCmd.OpenQuery "qryDeleteTX_STAAR_Alignments"
DoCmd.OpenQuery "qryDeleteTX_TEKS_MathPracticeHandpicks"
DoCmd.OpenQuery "qryDeleteCC_ToTX_Crosswalk"
DoCmd.OpenQuery "qryDeleteTX_ProcessHandAlignments"
DoCmd.OpenQuery "qryDeleteTX_TEKS_MathPracticeIndividualGradeCrosswalk"
DoCmd.OpenQuery "qryDeleteTX_STAAR_MathPracticeIndividualGradeCrosswalk"

'Set directory
strDir = "C:\Users\msmith\Documents\TEKS to STAAR\"

'Load STAAR alignments
strFile = DirName & "TX-STAAR Alignments for Access.xlsx"
strTable = "tblTX_STAAR_Alignments"
DoCmd.TransferSpreadsheet acImport, acSpreadsheetTypeExcel9, strTable, strFile, blnHasFieldNames

'Create table of TEKS Math alignments
DoCmd.OpenQuery "qryTX_TEKS_Math"

'Load CC to TX MP Crosswalk
strFile = DirName & "CC to TX MP Crosswalk.xlsx"
strTable = "tblCC_ToTX_Crosswalk"
DoCmd.TransferSpreadsheet acImport, acSpreadsheetTypeExcel9, strTable, strFile, blnHasFieldNames

'Load TX MP handpicks
strFile = DirName & "TX Process Standards Hand Alignments.xlsx"
strTable = "tblTX_ProcessHandAlignments"
DoCmd.TransferSpreadsheet acImport, acSpreadsheetTypeExcel9, strTable, strFile, blnHasFieldNames

'################  TEKS   ############

'Load TEKS MP grade-specific crosswalk
strFile = DirName & "TX TEKS Math Practice Individual Grade Crosswalk.xlsx"
strTable = "tblTX_TEKS_MathPracticeIndividualGradeCrosswalk"
DoCmd.TransferSpreadsheet acImport, acSpreadsheetTypeExcel9, strTable, strFile, blnHasFieldNames

'For TEKS generate handpick list with grades (with grades from base alignments)
DoCmd.OpenQuery "qryTX_TEKS_MathPracticeHandpicks"
'For TEKS generate list from crosswalk (with grades from base alignments)
DoCmd.OpenQuery "qryTX_TEKS_FromCC_Crosswalk"

'Merge Handpicks and crosswalk data
DoCmd.OpenQuery "qryTX_TEKS_MathPracticeTotalMakeTable"

'Remove duplicates and add to MathPracticeComplete table
DoCmd.OpenQuery "qryTX_TEKS_MathPracticeAddToBase"

'################  STAAR   ###########

'Load STAAR MP grade-specific crosswalk
strFile = DirName & "TX STAAR Math Practice Individual Grade Crosswalk.xlsx"
strTable = "tblTX_STAAR_MathPracticeIndividualGradeCrosswalk"
DoCmd.TransferSpreadsheet acImport, acSpreadsheetTypeExcel9, strTable, strFile, blnHasFieldNames

'For STAAR generate handpick list with grades (with grades from base alignments)
DoCmd.OpenQuery "qryTX_STAAR_MathPracticeHandpicks"

'For TEKS generate list from crosswalk (with grades from base alignments)
DoCmd.OpenQuery "qryTX_STAAR_FromCC_Crosswalk"

'Merge Handpicks and crosswalk data
DoCmd.OpenQuery "qryTX_STAAR_MathPracticeTotalMakeTable"

'Remove duplicates and add to MathPracticeComplete table
DoCmd.OpenQuery "qryTX_STAAR_MathPracticeAddToBase"

DoCmd.SetWarnings True
ExitSub:
 rs.Close
 db.Close
 Set rs = Nothing
 Set db = Nothing
 Exit Sub
ErrorExit:
 MsgBox Err.Description
 Resume ExitSub
End Sub

